<div class="admin-page">
  <div class="page-header">
    <div><h1>Classrooms</h1><p class="text-muted">Manage physical spaces</p></div>
    <button class="btn btn-primary" (click)="openCreate()">+ Add Classroom</button>
  </div>

  <div class="alert alert-success" *ngIf="success">{{ success }}</div>
  <div class="alert alert-danger" *ngIf="error && !showModal">{{ error }}</div>

  <div class="card">
    <div class="loading" *ngIf="loading">Loading...</div>
    <table class="table" *ngIf="!loading && classrooms.length">
      <thead>
        <tr><th>Code</th><th>Location</th><th>Type</th><th>Capacity</th><th>PCs</th><th>Status</th><th>Actions</th></tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of classrooms">
          <td><code>{{ c.code }}</code></td>
          <td>{{ c.building }} - Floor {{ c.floor }}, #{{ c.number }}</td>
          <td class="capitalize">{{ getTypeLabel(c.type) }}</td>
          <td>{{ c.capacity }}</td>
          <td>{{ c.pcs }}</td>
          <td><span class="badge" [class.badge-success]="c.status === 'available'" [class.badge-warning]="c.status === 'maintenance'" [class.badge-muted]="c.status === 'unavailable'">{{ c.status }}</span></td>
          <td class="actions">
            <button class="btn btn-sm btn-ghost" (click)="openEdit(c)">Edit</button>
            <button class="btn btn-sm btn-ghost btn-danger" (click)="delete(c)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="empty" *ngIf="!loading && !classrooms.length"><p>No classrooms found</p><button class="btn btn-primary" (click)="openCreate()">Add your first classroom</button></div>
  </div>
</div>

<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal modal-lg" (click)="$event.stopPropagation()">
    <div class="modal-header"><h2>{{ editing ? 'Edit' : 'New' }} Classroom</h2><button class="btn-close" (click)="closeModal()">Ã—</button></div>
    <div class="modal-body">
      <div class="alert alert-danger" *ngIf="error">{{ error }}</div>
      <div class="form-row">
        <div class="form-group"><label>Code *</label><input type="text" [(ngModel)]="form.code" placeholder="e.g. LAB-A1" required></div>
        <div class="form-group"><label>Building *</label><input type="text" [(ngModel)]="form.building" required></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>Floor</label><input type="number" [(ngModel)]="form.floor" min="0"></div>
        <div class="form-group"><label>Number</label><input type="text" [(ngModel)]="form.number" placeholder="e.g. 101"></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>Type</label><select [(ngModel)]="form.type"><option value="classroom">Classroom</option><option value="laboratory">Laboratory</option><option value="auditorium">Auditorium</option></select></div>
        <div class="form-group"><label>Status</label><select [(ngModel)]="form.status"><option value="available">Available</option><option value="maintenance">Maintenance</option><option value="unavailable">Unavailable</option></select></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>Capacity</label><input type="number" [(ngModel)]="form.capacity" min="1"></div>
        <div class="form-group"><label>PCs</label><input type="number" [(ngModel)]="form.pcs" min="0"></div>
      </div>
      <div class="form-group"><label>Equipment (comma separated)</label><input type="text" [(ngModel)]="equipmentInput" (blur)="updateEquipment()" placeholder="Projector, Whiteboard, AC"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" (click)="closeModal()">Cancel</button>
      <button class="btn btn-primary" (click)="save()">{{ editing ? 'Update' : 'Create' }}</button>
    </div>
  </div>
</div>
